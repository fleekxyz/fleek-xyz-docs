"use strict";(self.webpackChunkdocta=self.webpackChunkdocta||[]).push([[5943],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var i=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=i.createContext({}),u=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=u(e.components);return i.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),p=u(n),m=o,h=p["".concat(l,".").concat(m)]||p[m]||d[m]||a;return n?i.createElement(h,s(s({ref:t},c),{},{components:n})):i.createElement(h,s({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=m;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r[p]="string"==typeof e?e:o,s[1]=r;for(var u=2;u<a;u++)s[u]=n[u];return i.createElement.apply(null,s)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8831:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>u});var i=n(7462),o=(n(7294),n(3905));const a={draft:!1,title:"Sites | CLI",sidebarCollapsible:!1,sidebar_position:8,date:new Date("2023-01-10T09:00:00.000Z"),description:"Set and deploy your site with Fleek. Follow our concise CLI guide to create your site and leverage GitHub Actions to automate IPFS deployments through Continuous Integration.",category:"Documentation",keywords:["services","documentation","getting started"],tags:["Accounts","Guide","Learn","Fleek"]},s=void 0,r={unversionedId:"CLI/sites",id:"CLI/sites",title:"Sites | CLI",description:"Set and deploy your site with Fleek. Follow our concise CLI guide to create your site and leverage GitHub Actions to automate IPFS deployments through Continuous Integration.",source:"@site/docs/CLI/sites.md",sourceDirName:"CLI",slug:"/CLI/sites",permalink:"/docs/CLI/sites",draft:!1,tags:[{label:"Accounts",permalink:"/docs/tags/accounts"},{label:"Guide",permalink:"/docs/tags/guide"},{label:"Learn",permalink:"/docs/tags/learn"},{label:"Fleek",permalink:"/docs/tags/fleek"}],version:"current",sidebarPosition:8,frontMatter:{draft:!1,title:"Sites | CLI",sidebarCollapsible:!1,sidebar_position:8,date:"2023-01-10T09:00:00.000Z",description:"Set and deploy your site with Fleek. Follow our concise CLI guide to create your site and leverage GitHub Actions to automate IPFS deployments through Continuous Integration.",category:"Documentation",keywords:["services","documentation","getting started"],tags:["Accounts","Guide","Learn","Fleek"]},sidebar:"default",previous:{title:"IPNS | CLI",permalink:"/docs/CLI/ipns"},next:{title:"SDK",permalink:"/docs/SDK/"}},l={},u=[{value:"Seting up a Site",id:"seting-up-a-site",level:3},{value:"Deploy a Site",id:"deploy-a-site",level:3},{value:"Continuous Integration (CI)",id:"continuous-integration-ci",level:3}],c={toc:u};function p(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,i.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"seting-up-a-site"},"Seting up a Site"),(0,o.kt)("p",null,"To begin a deployment, you must first set up a site. To do this, you must be authenticated in the CLI and have a project selected. If you are not authenticated or have not selected a project, the CLI can help you. Use the ",(0,o.kt)("inlineCode",{parentName:"p"},"sites init")," command to start the setup process."),(0,o.kt)("p",null,"For this example we are using a Next.js application that you can find in the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/fleekxyz/templates/tree/main/example-apps"},"template repository"),".\nWhen you start the process, you will be prompted to create a new site or use an existing one. "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shellscript",metastring:'filename="Initializing a site" copy',filename:'"Initializing',a:!0,'site"':!0,copy:!0},"> fleek sites init\nWARN! Fleek CLI is in beta phase, use it under your own responsibility\n? Choose one of the existing sites or create a new one. \u203a \n\u276f   Create a new site\n")),(0,o.kt)("p",null,"Let's start by creating a new one and inputting a name for the site. "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shellscript",metastring:'filename="Initializing a site" copy',filename:'"Initializing',a:!0,'site"':!0,copy:!0},"\u2714 Choose one of the existing sites or create a new one. \u203a Create a new site\n\u2714 Type name of you new site. \u2026 fleek-demo-docs\n")),(0,o.kt)("p",null,"With the site name in place, you will have to input the directory where the build files will be stored. In this example, we are using a Next.js application thus the output directory is ",(0,o.kt)("inlineCode",{parentName:"p"},"out"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shellscript",metastring:'filename="Initializing a site" copy',filename:'"Initializing',a:!0,'site"':!0,copy:!0},"\u2714 Choose one of the existing sites or create a new one. \u203a Create a new site\n\u2714 Type name of you new site. \u2026 fleek-demo-docs\n\u2714 Specify the dist directory from where the site will be uploaded from > out\n")),(0,o.kt)("p",null,"Then you'll need to configure the build command that will run before the files are uploaded. In this case we have configured the ",(0,o.kt)("inlineCode",{parentName:"p"},"npm run build")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shellscript",metastring:'filename="Initializing a site" copy',filename:'"Initializing',a:!0,'site"':!0,copy:!0},'\u2714 Choose one of the existing sites or create a new one. \u203a Create a new site\n\u2714 Type name of you new site. \u2026 fleek-demo-docs\n\u2714 Specify the dist directory from where the site will be uploaded from > out \n\u2714 Do you want to include the optional "build" command? \u2026 yes\n\u2714 Specify `build` command \u2026 npm run build\n')),(0,o.kt)("p",null,"And the last step is choosing the format for your configuration file. If you choose the ",(0,o.kt)("inlineCode",{parentName:"p"},"Typescript")," option please ensure that the Fleek SDK is included in your project dependencies to avoid deployment errors."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shellscript",metastring:'filename="Initializing a site" copy',filename:'"Initializing',a:!0,'site"':!0,copy:!0},'\u2714 Choose one of the existing sites or create a new one. \u203a Create a new site\n\u2714 Type name of you new site. \u2026 fleek-demo-docs\n\u2714 Specify the dist directory from where the site will be uploaded from > out \n? Do you want to include the optional "build" command? \u203a (Y/n)\n? Select a format how the site\'s configuration will be saved: \u203a\n>    Typescript (fleek.config.ts)\n>    Javascript (fleek.config.js)\n>    JSON (fleek.config.json)\n')),(0,o.kt)("p",null,"That's it! Your site is set up. You will see a file named fleek.json has been created in your directory, which holds the configuration to deploy the site."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shellscript",metastring:'filename="Initializing a site" copy',filename:'"Initializing',a:!0,'site"':!0,copy:!0},'\u2714 Choose one of the existing sites or create a new one. \u203a Create a new site\n\u2714 Type name of you new site. \u2026 fleek-demo-docs\n\u2714 Specify the dist directory from where the site will be uploaded from > out \n\u2714 Do you want to include the optional "build" command? \u2026 yes\n\u2714 Specify `build` command \u2026 npm run build\n\u2714 Select a format how the site\'s configuration will be saved: \u203a JSON (fleek.config.json)\n> Success! Fleek config file has been saved.\n')),(0,o.kt)("h3",{id:"deploy-a-site"},"Deploy a Site"),(0,o.kt)("p",null,"To deploy your site, simply run the ",(0,o.kt)("inlineCode",{parentName:"p"},"sites deploy")," command in the same directory where you set up the site."),(0,o.kt)("p",null," When you start the process, you will be prompted to create a new site or use an existing one. This process will first run the build command you have in the ",(0,o.kt)("inlineCode",{parentName:"p"},"fleek.json")," file and the upload the build directory to the desired storage."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shellscript",metastring:'filename="Deploying a site" copy',filename:'"Deploying',a:!0,'site"':!0,copy:!0},"WARN! Fleek CLI is in beta, use it at your own discretion\n> Success! Deployed!\n> Site IPFS CID: QmP1nDyoHqSrRabwUSrxRV3DJqiKH7b9t1tpLcr1NTkm1M\n\n> You can visit through the gateway:\n> https://ipfs.io/ipfs/QmP1nDyoHqSrRabwUSrxRV3DJqiKH7b9t1tpLcr1NTkm1M\n")),(0,o.kt)("h3",{id:"continuous-integration-ci"},"Continuous Integration (CI)"),(0,o.kt)("p",null,"Imagine you're working on a group project. You want to check a new pull request (PR) and see how the changes look on the site you're creating. To do this, you need to check out the branch of the PR, build it, and run the project to check it live. Wouldn't it be great if, after a PR is made, a new version of the project is built and uploaded so anyone can run tests on it?"),(0,o.kt)("p",null,"Even better, wouldn't it be fantastic if, when you merge to your ",(0,o.kt)("inlineCode",{parentName:"p"},"main")," branch, a deployment to production is made immediately? This is where Continuous Integration comes into play. For CI there are many options, currently on Fleek we are offering an automatic integration with:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Github Actions - ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/features/actions"},"Read more"))),(0,o.kt)("p",null,"To set up the CI you need to use the ",(0,o.kt)("inlineCode",{parentName:"p"},"fleek sites ci")," command. This command will create a new workflow file in your repository. You can then edit the file to add the desired configuration."),(0,o.kt)("p",null,"Using Github Actions as a CI will allow you to configure an action that automatically deployments your site to IPFS via Fleek upon a new commit, outputting the new hash."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shellscript",metastring:'filename="Seting up a CI" copy',filename:'"Seting',up:!0,a:!0,'CI"':!0,copy:!0},"> fleek sites ci\n")),(0,o.kt)("p",null,"Run the command above to start the process, your first step is to chose from the diferent CI providers. Currently we only support Github Actions."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shellscript",metastring:'filename="Seting up a CI" copy',filename:'"Seting',up:!0,a:!0,'CI"':!0,copy:!0},"> fleek sites ci\nWARN! Fleek CLI is in beta, use it at your own discretion\n? Select provider you want to use for building and deploying your sites \u203a - Use arrow-keys. Return to submit.\n\u276f   GitHub Actions - Generator of Github Actions YAML file\n")),(0,o.kt)("p",null,"Next you need to set up the directory where the workflow file will be created. The CLI will create a new directory called ",(0,o.kt)("inlineCode",{parentName:"p"},".github/workflows")," and will create a new file called ",(0,o.kt)("inlineCode",{parentName:"p"},"fleek-deploy.yml")," inside it. If the directory already exists, the CLI will ask you if you want to overwrite the existing file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shellscript",metastring:'filename="Seting up a CI" copy',filename:'"Seting',up:!0,a:!0,'CI"':!0,copy:!0},"> fleek sites ci\nWARN! Fleek CLI is in beta, use it at your own discretion\n? Workflow config will be saved in: CWD/.github/workflows/fleek-deploy.yaml. Would you like to specify a different path? \u203a No / Yes\nWARN! Can't find .github/workflows directory.\nWARN! Creating .github/workflows directory. \n> Success! Github Actions workflow was saved to CWD/.github/workflows/fleek-deploy.yaml file.\n")),(0,o.kt)("p",null,"Now you can go to ",(0,o.kt)("inlineCode",{parentName:"p"},".github/workflows/fleek-deploy.yaml")," and you will find a file similar to this"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'filename="fleek-deploy.yaml" copy',filename:'"fleek-deploy.yaml"',copy:!0},"name: Deploy site via Fleek\non: push\njobs:\n    deploy-to-fleek:\n    runs-on: ubuntu-latest\n    env:\n        FLEEK_TOKEN: ${{ secrets.FLEEK_TOKEN }}\n        FLEEK_PROJECT_ID: ${{ secrets.FLEEK_PROJECT_ID }}\n    steps:\n        - name: Checkout\n        uses: actions/checkout@v3\n        - name: Install Node.js\n        uses: actions/setup-node@v3\n        with:\n            node-version: 16\n        - name: Install Fleek CLI\n        run: npm i -g @fleekxyz/cli\n        - name: Build & deploy sites\n        run: fleek sites deploy\n")),(0,o.kt)("p",null,"As you can see there are two secrets ",(0,o.kt)("inlineCode",{parentName:"p"},"secrets.FLEEK_TOKEN")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"secrets.FLEEK_PROJECT_ID"),". This is information that has been outputed at the end of the process and you need to configure it in your Github Repository."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shellscript",metastring:'filename="Github Secrets"',filename:'"Github','Secrets"':!0},"> Set following secrets in your Github repository settings:\n\nName              Value                    \n-------------------------------------------\nFLEEK_TOKEN       <VALUE>\nFLEEK_PROJECT_ID  <VALUE>\n\n")),(0,o.kt)("p",null,"Go back to your Github Repository settings and configure these secrets. Go to ",(0,o.kt)("inlineCode",{parentName:"p"},"Settings > Secrets > New repository secret")," and add add the secrets."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"GHA-Secrets",src:n(8556).Z,width:"808",height:"353"})),(0,o.kt)("p",null,"Once you set them up they should look like this."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"GHA-Secrets-2",src:n(5512).Z,width:"782",height:"199"})),(0,o.kt)("p",null,"Next, go to your Github Repository and make a new commit. You should see a new workflow running! To check the results go to Actions and you will see the workflow running. Once its finished you can get the CID and Gateways url of your site."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"GHA-Workflow",src:n(4868).Z,width:"801",height:"144"})))}p.isMDXComponent=!0},5512:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/gha-secrets-2-c4749d4d7123e988f60d2d6c2d7a14bc.png"},8556:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/gha-secrets-aac1f2a7b4908f865a425c59cd8e6e10.png"},4868:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/gha-workflow-18f094e788639d1337114b3b7d5e2e06.png"}}]);